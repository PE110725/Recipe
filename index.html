<!DOCTYPE html>
<html>
<head>
  <title>Product Entry Form</title>
  <style>
    body { font-family: Arial; max-width: 600px; margin: auto; }
    label, input, select, button { display: block; margin-top: 10px; width: 100%; }
    .item-row { display: flex; gap: 10px; margin-top: 10px; }
    .item-row input { flex: 1; }
  </style>
</head>
<body>
  <h2>Product Entry Form</h2>
  <form id="entryForm">
    <label for="polymer">Polymer</label>
    <select id="polymer" name="polymer" required>
      <option value="">Select Polymer</option>
      <option>PE</option><option>PVC</option><option>EVA</option><option>ABS</option><option>SAN</option>
      <option>GPPS</option><option>NYLON</option><option>PET</option><option>PC</option><option>PTFE</option>
      <option>R-PE</option><option>R-LD</option><option>R-LLD</option><option>R-PPCP</option><option>R-PVC</option>
      <option>R-EVA</option><option>R-ABS</option><option>R-SAN</option><option>R-GGPS</option><option>R-PET</option><option>R-NYLON</option>
    </select>

    <label for="product">Product Name</label>
    <input type="text" id="product" name="product" required>

    <label for="color">Color</label>
    <input type="text" id="color" name="color" required>

    <label>Items</label>
    <div id="itemsContainer">
      <div class="item-row">
        <input type="text" placeholder="Item Name" name="items[]">
        <input type="number" step="0.001" placeholder="Weight (kg)" name="weights[]">
      </div>
    </div>
    <button type="button" onclick="addItem()">Add More Item</button>

    <button type="submit">Submit</button>
  </form>

  <script>
    function addItem() {
      const container = document.getElementById("itemsContainer");
      const row = document.createElement("div");
      row.className = "item-row";
      row.innerHTML = `
        <input type="text" placeholder="Item Name" name="items[]">
        <input type="number" step="0.001" placeholder="Weight (kg)" name="weights[]">
      `;
      container.appendChild(row);
    }

    document.getElementById("entryForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const formData = new FormData(e.target);

      const items = [];
      const weights = [];

      document.querySelectorAll('input[name="items[]"]').forEach(input => items.push(input.value.toUpperCase()));
      document.querySelectorAll('input[name="weights[]"]').forEach(input => weights.push(parseFloat(input.value)));

      const payload = {
        polymer: formData.get("polymer").toUpperCase(),
        product: formData.get("product").toUpperCase(),
        color: formData.get("color").toUpperCase(),
        items: JSON.stringify(items),
        weights: JSON.stringify(weights)
      };

      fetch("https://script.google.com/macros/s/AKfycbwUg2MWJtIq0_9ibeHWMQoq5PUHNncfruyAGQI2cB8/dev", {
        method: "POST",
        body: new URLSearchParams(payload)
      })
      .then(res => alert("Submitted Successfully!"))
      .catch(err => alert("Error submitting form"));
    });
  </script>
</body>
</html>
